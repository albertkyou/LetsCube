(this["webpackJsonpletscube-client"]=this["webpackJsonpletscube-client"]||[]).push([[0],{135:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')},175:function(e,t,n){e.exports=n(218)},180:function(e,t,n){},212:function(e,t){},218:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),i=n(14),c=n.n(i),s=(n(180),n(144)),l=n(15),u=n(61),m=n(304),d=n(305),p=n(83),f=n(146),h=Object(f.a)({palette:{primary:{main:"#556cd6"},secondary:{main:p.a.A400},background:{default:"#fff"}},typography:{fontSize:12}}),b=n(54),E=n(132),v=n(100),g=n(130),O=n(23),N=n(4),y=n(18),j=n(8),I=function(e){return{type:"rooms/create",options:e}},w={rooms:[]},C=(a={},Object(N.a)(a,"rooms/updated",(function(e,t){return Object(j.a)({},e,{fetching:!1,rooms:t.rooms})})),Object(N.a)(a,"rooms/created",(function(e,t){return Object(j.a)({},e,{rooms:[].concat(Object(y.a)(e.rooms),[t.room])})})),Object(N.a)(a,"rooms/deleted",(function(e,t){return Object(j.a)({},e,{rooms:e.rooms.filter((function(e){return e._id!==t.room}))})})),Object(N.a)(a,"rooms/room_updated",(function(e,t){return{rooms:e.rooms.map((function(e){return e._id===t.room._id?t.room:e}))}})),a);var T,S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;return C[t.type]?C[t.type](e,t):e},_=function(e){return{type:"room/updated",fetching:!1,room:e}},k=function(e){return{type:"room/fetch",fetching:!0,id:e}},R=function(e){return{type:"room/delete",id:e}},x=function(e,t){return{type:"room/join",id:e,password:t}},D=function(e){return{type:"room/submit_result",result:e}},M=function(e){return{type:"room/send_status",status:e}},G=function(e){return{type:"room/request_scramble",admin:e}},P=function(e){return{type:"room/change_event",event:e}},F=function(e){return{type:"room/update_competing",competing:e}},A={fetching:null,_id:null,name:null,event:null,accessCode:null,private:null,password:null,users:[],statuses:{},attempts:[],competing:{},waitingFor:[],admin:{id:null}},U=(T={},Object(N.a)(T,"room/updated",(function(e,t){return Object(j.a)({},e,{fetching:!1},t.room)})),Object(N.a)(T,"room/fetch",(function(e,t){return Object(j.a)({},e,{fetching:t.fetching})})),Object(N.a)(T,"room/user_join",(function(e,t){return Object(j.a)({},e,{users:e.users.concat(t.user),competing:Object(j.a)({},e.competing,Object(N.a)({},t.user.id,!0))})})),Object(N.a)(T,"room/user_left",(function(e,t){return Object(j.a)({},e,{users:e.users.filter((function(e){return e.id!==t.user}))})})),Object(N.a)(T,"room/join",(function(e,t){return Object(j.a)({},e,{password:t.password})})),Object(N.a)(T,"room/leave",(function(e){return Object(j.a)({},e,{name:void 0,_id:void 0,accessCode:void 0,users:[],statuses:{},attempts:[],competing:{},waitingFor:[],admin:{id:null}})})),Object(N.a)(T,"room/new_attempt",(function(e,t){return Object(j.a)({},e,{attempts:e.attempts.concat(t.attempt),waitingFor:t.waitingFor,new_scramble:!0})})),Object(N.a)(T,"room/new_result",(function(e,t){return Object(j.a)({},e,{attempts:e.attempts.map((function(e){return e.id===t.result.id?Object(j.a)({},e,{results:Object(j.a)({},e.results,Object(N.a)({},t.result.userId,t.result.result))}):e})),waitingFor:e.waitingFor.filter((function(e){return e!==t.result.userId}))})})),Object(N.a)(T,"room/update_admin",(function(e,t){return Object(j.a)({},e,{admin:t.admin})})),Object(N.a)(T,"room/receive_status",(function(e,t){return Object(j.a)({},e,{statuses:Object(j.a)({},e.statuses,Object(N.a)({},t.user,t.status))})})),Object(N.a)(T,"room/update_competing_for_user",(function(e,t){return Object(j.a)({},e,{competing:Object(j.a)({},e.competing,Object(N.a)({},t.userId,t.competing)),waitingFor:t.competing?e.waitingFor:e.waitingFor.filter((function(e){return e!==t.userId}))})})),T);var L,B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;return U[t.type]?U[t.type](e,t):e},W={connected:!1,room:null,loginFailed:null},z=(L={},Object(N.a)(L,"socket/connected",(function(e){return Object(j.a)({},e,{connected:!0})})),Object(N.a)(L,"socket/disconnected",(function(e){return Object(j.a)({},e,{connected:!1})})),Object(N.a)(L,"socket/connection-changed",(function(e,t){return Object(j.a)({},e,{connected:t.connected,error:!1})})),Object(N.a)(L,"socket/join_room",(function(e,t){return Object(j.a)({},e,{room:t.room})})),Object(N.a)(L,"room/leave",(function(e){return Object(j.a)({},e,{room:null})})),Object(N.a)(L,"socket/login_failed",(function(e,t){return Object(j.a)({},e,{loginFailed:t.error})})),L);var J,H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;return z[t.type]?z[t.type](e,t):e},q=function(e){return{type:"user/changed",fetching:!1,user:e}},V=function(e){return{type:"user/update_profile",profile:e}},Y={fetching:!0,id:void 0,name:void 0,wcaId:void 0,showWCAID:void 0,canJoinRoom:void 0,preferUsername:void 0,displayName:void 0,useInspection:!1,avatar:{thumb_url:void 0}},K=(J={},Object(N.a)(J,"user/changed",(function(e,t){return Object(j.a)({},e,{fetching:!1},t.user)})),Object(N.a)(J,"user/fetching",(function(e){return Object(j.a)({},e,{fetching:!0})})),Object(N.a)(J,"user/update_profile",(function(e,t){return Object(j.a)({},e,{},t.profile)})),J);var Q,X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;return K[t.type]?K[t.type](e,t):e},$=function(e){return{type:"messages/new",message:e}},Z=function(e){return{type:"messages/close",index:e}},ee={messages:[]},te=(Q={},Object(N.a)(Q,"messages/new",(function(e,t){return Object(j.a)({},e,{messages:e.messages.concat([t.message])})})),Object(N.a)(Q,"messages/close",(function(e,t){return Object(j.a)({},e,{messages:e.messages.filter((function(e,n){return n!==t.index}))})})),Q);var ne,ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;return te[t.type]?te[t.type](e,t):e},re=function(e){return{type:"chat/send_chat",message:e}},oe=function(e){return{type:"chat/receive_chat",message:e}},ie={messages:[],users:[]},ce=(ne={},Object(N.a)(ne,"chat/receive_chat",(function(e,t){return Object(j.a)({},e,{messages:e.messages.concat([t.message])})})),Object(N.a)(ne,"room/updated",(function(e,t){var n=t.room.users,a=void 0===n?[]:n;return Object(j.a)({},e,{users:a.concat(e.users.filter((function(e){return a.findIndex((function(t){return t.id===e.id}))>-1})))})})),Object(N.a)(ne,"room/leave",(function(){return{messages:[],users:[]}})),Object(N.a)(ne,"room/user_join",(function(e,t){return Object(j.a)({},e,{users:e.users.concat(t.user)})})),ne);var se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;return ce[t.type]?ce[t.type](e,t):e},le=n(21),ue=n(309),me=n(9),de=n(46),pe=n(133),fe=n.n(pe);Error.stackTraceLimit=1/0;var he=function e(t){var n=this;Object(de.a)(this,e),this.connect=function(){n.socket=fe()("/",{reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,autoConnect:!0,"force new connection":!1}),n.socket.on(me.CONNECT,n._onConnected),n.socket.on(me.DISCONNECT,n.onDisconnected),n.socket.on(me.CONNECT_ERR,n.onError),n.socket.on(me.RECONNECT_ERR,n.onError),n.socket.on(me.reconnect,n.onReconnect),Object.keys(n.events).forEach((function(e){n.socket.on(e,n.events[e])}))},this._onConnected=function(){console.log("[SOCKET.IO]",me.CONNECT),n.onConnected&&n.onConnected()},this.onDisconnected=function(){console.log("[SOCKET.IO]",me.DISCONNECT),n.onDisconnected&&n.onDisconnected()},this.disconnect=function(){return n.socket.close()},this.onError=function(e){console.log("[SOCKET.IO]","error",e)},this.emit=function(e,t){n.socket.emit(e,t)},t.onChange&&(this.onChange=t.onChange),t.onError&&(this.onError=t.onError),t.onConnected&&(this.onConnected=t.onConnected),t.onDisconnected&&(this.onDisconnected=t.onDisconnected),this.onReconnect=t.onReconnect,this.events=t.events,this.socket=null},be=function(e){var t,n,a=new he({onChange:function(t){e.dispatch(function(e){return{type:"socket/connection-changed",connected:e,isError:!1}}(t))},onConnected:function(){e.dispatch({type:"socket/connected",connected:!0})},onDisconnected:function(){e.dispatch({type:"socket/disconnected",connected:!1})},events:(t={},Object(N.a)(t,me.RECONNECT,(function(){console.log("[SOCKET.IO] reconnected!"),e.getState().room.accessCode&&e.dispatch(x(e.getState().room._id,e.getState().room.password))})),Object(N.a)(t,me.ERROR,(function(t){console.log("[SOCKET.IO]",t),404===t.statusCode?e.dispatch(Object(le.d)("/")):403===t.statusCode&&t.event===me.JOIN_ROOM?(e.dispatch(function(e){return{type:"socket/login_failed",error:e}}({error:t})),e.dispatch($({severity:"error",text:t.message}))):t.statusCode>=400&&t.redirect&&e.dispatch(Object(le.d)(t.redirect))})),Object(N.a)(t,me.UPDATE_ROOMS,(function(t){e.dispatch(function(e){return{type:"rooms/updated",fetching:!1,rooms:e}}(t))})),Object(N.a)(t,me.UPDATE_ROOM,(function(t){e.dispatch(_(t))})),Object(N.a)(t,me.GLOBAL_ROOM_UPDATED,(function(t){e.dispatch(function(e){return{type:"rooms/room_updated",room:e}}(t))})),Object(N.a)(t,me.ROOM_CREATED,(function(t){e.dispatch(function(e){return{type:"rooms/created",room:e}}(t))})),Object(N.a)(t,me.ROOM_DELETED,(function(t){e.dispatch(function(e){return{type:"rooms/deleted",room:e}}(t)),t===e.getState().room._id&&(e.dispatch({type:"room/leave"}),e.dispatch(Object(le.d)("/")))})),Object(N.a)(t,me.UPDATE_ADMIN,(function(t){e.dispatch(function(e){return{type:"room/update_admin",admin:e}}(t));var n=t.id===e.getState().user.id?"You are":"".concat(t.displayName," is");e.dispatch(oe({id:Object(ue.a)(),userId:-1,text:"".concat(n," in control now."),icon:"ADMIN"}))})),Object(N.a)(t,me.FORCE_JOIN,(function(t){e.dispatch(Object(le.d)("/rooms/".concat(t._id)))})),Object(N.a)(t,me.JOIN,(function(t){e.dispatch(function(e){return{type:"socket/join_room",room:e}}(t.accessCode)),e.dispatch(_(t)),e.dispatch($({severity:"success",text:"room joined"}))})),Object(N.a)(t,me.USER_JOIN,(function(t){e.dispatch(function(e){return{type:"room/user_join",user:e}}(t)),e.dispatch(oe({id:Object(ue.a)(),userId:-1,text:"".concat(t.displayName," Joined"),icon:"USER"}))})),Object(N.a)(t,me.USER_LEFT,(function(t){e.dispatch(oe({id:Object(ue.a)(),userId:-1,text:"".concat(e.getState().room.users.find((function(e){return e.id===t})).displayName," Left"),icon:"USER"})),e.dispatch(function(e){return{type:"room/user_left",user:e}}(t))})),Object(N.a)(t,me.NEW_ATTEMPT,(function(t){var n=t.attempt,a=t.waitingFor;e.dispatch(function(e,t){return{type:"room/new_attempt",attempt:e,waitingFor:t}}(n,a)),e.dispatch(oe({id:Object(ue.a)(),userId:-1,text:"A new scramble is here",secondary:n.scrambles.join(", "),icon:"SCRAMBLE",event:e.getState().room.event}))})),Object(N.a)(t,me.NEW_RESULT,(function(t){e.dispatch(function(e){return{type:"room/new_result",result:e}}(t))})),Object(N.a)(t,me.MESSAGE,(function(t){e.dispatch(oe(t))})),Object(N.a)(t,me.UPDATE_STATUS,(function(t){var n=t.user,a=t.status;e.dispatch(function(e,t){return{type:"room/receive_status",user:e,status:t}}(n,a))})),Object(N.a)(t,me.UPDATE_COMPETING,(function(t){var n=t.userId,a=t.competing;e.dispatch(function(e,t){return{type:"room/update_competing_for_user",userId:e,competing:t}}(n,a));var r=n===e.getState().user.id?"You are":"".concat(e.getState().room.users.find((function(e){return e.id===n})).displayName," is");e.dispatch(oe({id:Object(ue.a)(),userId:-1,text:"".concat(r," ").concat(a?"competing":"skipping"),icon:"USER"}))})),t)}),r=(n={"@@router/LOCATION_CHANGE":function(t){var n=t.payload;"/"!==n.location.pathname&&"/profile"!==n.location.pathname||e.dispatch({type:"room/leave"})}},Object(N.a)(n,"socket/connect",(function(){a.connect()})),Object(N.a)(n,"socket/disconnect",(function(){a.disconnect()})),Object(N.a)(n,"room/fetch",(function(e){var t=e.id;a.emit(me.FETCH_ROOM,t)})),Object(N.a)(n,"room/delete",(function(e){var t=e.id;a.emit(me.DELETE_ROOM,t)})),Object(N.a)(n,"room/join",(function(e){var t=e.id,n=e.password;a.emit(me.JOIN_ROOM,{id:t,password:n})})),Object(N.a)(n,"rooms/create",(function(e){var t=e.options;a.emit(me.CREATE_ROOM,t)})),Object(N.a)(n,"room/leave",(function(){e.getState().room._id&&a.emit(me.LEAVE_ROOM)})),Object(N.a)(n,"room/submit_result",(function(e){a.emit(me.SUBMIT_RESULT,e.result)})),Object(N.a)(n,"room/request_scramble",(function(e){a.emit(me.REQUEST_SCRAMBLE,e.result)})),Object(N.a)(n,"room/change_event",(function(e){var t=e.event;a.emit(me.CHANGE_EVENT,t)})),Object(N.a)(n,"chat/send_chat",(function(e){var t=e.message;a.emit(me.MESSAGE,t)})),Object(N.a)(n,"room/send_status",(function(t){var n=t.status;a.emit(me.UPDATE_STATUS,{user:e.getState().user.id,status:n})})),Object(N.a)(n,"room/update_competing",(function(e){var t=e.competing;a.emit(me.UPDATE_COMPETING,t)})),n);return function(e){return function(t){r[t.type]&&r[t.type](t),e(t)}}},Ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||b.d,ve=Object(O.a)();v.a.initialize("UA-143761187-3",{debug:!1});var ge=Object(b.c)({router:Object(u.b)(ve),roomList:S,room:B,socket:H,user:X,messages:ae,chat:se}),Oe=[Object(g.a)(ve),E.a,be];Oe.push((function(){return function(e){return function(t){if("@@router/LOCATION_CHANGE"===t.type){var n="".concat(t.payload.location.pathname).concat(t.payload.location.search);a=n,v.a.pageview(a)}var a;return e(t)}}}));var Ne=b.a.apply(void 0,Oe),ye=Object(b.e)(ge,Ee(Ne)),je=n(30),Ie=n(224),we=n(300),Ce=n(310),Te=n(307),Se=n(268),_e=n(11),ke=n(38),Re=n(271),xe=n(273),De=n(56),Me=n(274),Ge=n(221),Pe=n(311),Fe=n(220),Ae=n(275),Ue=n(147),Le=n(223),Be=n(278),We=n(101),ze=n(272),Je=n(135),He=[{text:"Contribute Idea",url:"https://docs.google.com/forms/d/1YgroYi7_VRj2VrTxNa2ytV099MaVV9rGbC8KVH0tdx0/edit#responses"},{text:"Future",url:"https://github.com/coder13/LetsCube/wiki/Future"},{text:"GitHub",url:"https://github.com/coder13/letscube"},{text:"Contact",url:"mailto:choover11+letscube@gmail.com"},{text:"".concat(Je.a),url:"https://github.com/coder13/letscube"}],qe=Object(Se.a)((function(e){return{root:{padding:e.spacing(1)},grow:{flexGrow:1},link:{fontSize:"1.125em",margin:".5em",verticalAlign:"middle",color:"#7f7f7f","&:hover":{textDecoration:"none",opacity:.75}}}}));var Ve=function(){var e=qe();return o.a.createElement(We.a,{square:!0},o.a.createElement(Re.a,{container:!0,className:e.root,justify:"flex-end"},o.a.createElement(Re.a,{item:!0},He.map((function(t){return o.a.createElement(ze.a,{key:t.text,className:e.link,variant:"body2",href:t.url,target:"_blank",rel:"noopener noreferrer"},t.text)})))))},Ye=[{id:"333",name:"3x3"},{id:"222",name:"2x2"},{id:"444",name:"4x4"},{id:"555",name:"5x5"},{id:"666",name:"6x6"},{id:"777",name:"7x7"},{id:"minx",name:"Megaminx"},{id:"pyram",name:"Pyraminx"},{id:"clock",name:"Clock"},{id:"skewb",name:"Skewb"},{id:"sq1",name:"Square-1"}],Ke=function(e){return Ye.find((function(t){return t.id===e})).name},Qe=Object(Se.a)((function(){return{root:{display:"flex",flexDirection:"column",height:"100vh"},title:{flexGrow:1,minWidth:"6em"},titleLink:{color:"inherit",textDecoration:"none"},content:{display:"flex",flexGrow:1,flexDirection:"column"},roomTitleGrid:{flexGrow:1}}}));function Xe(e){var t=e.children,n=e.user,a=e.room,r=!!n.id,i=Qe(),c=o.a.useState(null),s=Object(_e.a)(c,2),l=s[0],u=s[1],m=Boolean(l);return o.a.createElement("div",{className:i.root},o.a.createElement(xe.a,{position:"relative",elevation:1},o.a.createElement(Me.a,null,o.a.createElement(De.a,{variant:"h6",className:i.title},o.a.createElement(ke.a,{to:"/",className:i.titleLink},"Let's Cube")),o.a.createElement(Re.a,{className:i.roomTitleGrid},a._id&&o.a.createElement(o.a.Fragment,null,o.a.createElement(De.a,{variant:"h6",component:"span"},o.a.createElement(ke.a,{to:"/rooms/".concat(a._id),className:i.titleLink},a.name)),o.a.createElement(De.a,{variant:"subtitle2",component:"span",style:{paddingLeft:"1em"}},Ke(a.event)))),r?o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(Fe.a,{style:{padding:".5em"}},o.a.createElement(Ae.a,{primary:o.a.createElement(De.a,{variant:"h6"},n.name),secondary:o.a.createElement(De.a,{variant:"caption"},n.wcaId)})),o.a.createElement(Ge.a,{onClick:function(e){u(e.currentTarget)},color:"inherit"},o.a.createElement(Pe.a,{src:n.avatar.thumb_url})),o.a.createElement(Ue.a,{id:"menu-appbar",anchorEl:l,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:m,onClose:function(){u(null)}},o.a.createElement(Be.a,{component:ke.a,to:"/profile",variant:"contained",color:"primary"},"Profile"),o.a.createElement(Be.a,{onClick:function(){window.location="/auth/logout?redirect=".concat(document.location.origin,"/")}},"Log out"))):o.a.createElement(Le.a,{color:"inherit",onClick:function(){window.location="/auth/login?redirect=".concat(document.location.href)}},"Login"))),o.a.createElement("main",{className:i.content},t),o.a.createElement(Ve,null))}Xe.defaultProps={user:{id:void 0,name:void 0,wcaId:void 0,avatar:{thumb_url:void 0}},room:{_id:void 0,name:void 0,event:void 0}};var $e=Object(l.c)((function(e){return{roomName:e.room.name}}))(Xe),Ze=n(287),et=n(289),tt=n(277),nt=n(286),at=n(288),rt=n(138),ot=n.n(rt),it=n(282),ct=n(284),st=n(283),lt=n(279),ut=n(285),mt=n(281),dt=n(280),pt=Object(Se.a)((function(e){return{fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}}));function ft(e){var t=e.open,n=e.onCreateRoom,a=e.onClose,i=pt(),c=Object(r.useState)(""),s=Object(_e.a)(c,2),l=s[0],u=s[1],m=Object(r.useState)(!1),d=Object(_e.a)(m,2),p=d[0],f=d[1],h=Object(r.useState)(""),b=Object(_e.a)(h,2),E=b[0],v=b[1],g=function(){u(""),f(!1),v(""),a()};return o.a.createElement(lt.a,{open:t,onClose:g},o.a.createElement(dt.a,null,"Create Room"),o.a.createElement(mt.a,{className:i.paper},o.a.createElement(it.a,{id:"roomName",label:"Room Name",onChange:function(e){e.target.value.length<100&&u(e.target.value)},value:l,autoComplete:"off",autoFocus:!0,fullWidth:!0}),o.a.createElement(st.a,{label:"Private Room?",control:o.a.createElement(ct.a,{checked:p,onChange:function(){f(!p)}})}),o.a.createElement(it.a,{id:"password",label:"Password",type:"password",disabled:!p,onChange:function(e){v(e.target.value)},autoFocus:!0,fullWidth:!0})),o.a.createElement(ut.a,null,o.a.createElement(Le.a,{onClick:function(){n({name:l,password:E})},color:"primary",disabled:!l||p&&!E},"Create"),o.a.createElement(Le.a,{onClick:g,color:"secondary"},"Cancel")))}ft.defaultProps={open:!1};var ht=ft,bt=n(137),Et=n.n(bt),vt=n(136),gt=n.n(vt);function Ot(e){var t=e.children,n=e.to,a=e.disabled;return o.a.createElement(Fe.a,{button:!0,component:ke.a,to:n,disabled:a},t)}Ot.defaultProps={disabled:!1};var Nt=Ot;function yt(e){var t=e.room,n=e.disabled,a=0===t.usersLength?" empty":" ".concat(t.usersLength," user").concat(t.usersLength>1?"s":"").concat(t.users?": ".concat(t.users.join(", ")):"");return o.a.createElement(Nt,{to:"/rooms/".concat(t._id),disabled:n},o.a.createElement(nt.a,null,t.private?o.a.createElement(gt.a,null):o.a.createElement(Et.a,null)),o.a.createElement(Ae.a,{primary:o.a.createElement(De.a,{variant:"h6"},"".concat(t.name," (").concat(Ke(t.event),")")),secondary:o.a.createElement(De.a,null,a)}))}yt.defaultProps={room:{_id:void 0,name:void 0,event:void 0,private:!1,usersLength:0,users:void 0},disabled:!0};var jt=yt,It=Object(Se.a)((function(e){return{alert:{padding:"1em","& a":{color:e.palette.warning.contrastText,textDecoration:"none"}},createRoom:{padding:"1em"}}}));function wt(e){var t=e.dispatch,n=e.rooms,a=e.user,r=It(),i=o.a.useState(!1),c=Object(_e.a)(i,2),s=c[0],l=c[1],u=n.filter((function(e){return!e.private})),m=n.filter((function(e){return!!e.private})),d=!!a.id&&!a.canJoinRoom;return o.a.createElement(Ze.a,{maxWidth:"md",disableGutters:!0,style:{padding:"1em"}},d&&o.a.createElement(Te.a,{className:r.alert,severity:"error",action:o.a.createElement(Le.a,{component:ke.a,color:"inherit",variant:"filled",to:"/profile"},"GO TO PROFILE")},o.a.createElement(ke.a,{to:"/profile"},"Must update profile settings before joining a room.")),o.a.createElement("br",null),a.id&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Fe.a,{button:!0,className:r.createRoom,variant:"contained",color:"primary",component:Le.a,onClick:function(){return l(!0)}},o.a.createElement(nt.a,null,o.a.createElement(ot.a,null)),"Create Room"),o.a.createElement("br",null)),o.a.createElement(We.a,null,o.a.createElement(tt.a,{subheader:o.a.createElement(at.a,null,"Public Rooms")},u.map((function(e){return o.a.createElement(jt,{key:e._id,room:e,disabled:d})}))),o.a.createElement(et.a,null),o.a.createElement(tt.a,{subheader:o.a.createElement(at.a,null,"Private Rooms")},m.map((function(e){return o.a.createElement(jt,{key:e._id,room:e,disabled:d})})))),o.a.createElement(ht,{open:s,onCreateRoom:function(e){t(I(e))},onClose:function(){return l(!1)}}))}wt.defaultProps={rooms:[],user:{id:void 0,canJoinRoom:!1}};var Ct=Object(l.c)((function(e){return{rooms:e.roomList.rooms,user:e.user}}))(wt),Tt=n(36),St=n(79),_t=n(80),kt=n(82),Rt=n(2),xt=n(5),Dt=n(301),Mt=n(302),Gt=n(143),Pt=n.n(Gt),Ft=n(142),At=n.n(Ft),Ut=Object(Se.a)((function(e){return{root:{display:"flex",flexGrow:1,flexDirection:"column",padding:e.spacing(0),borderRadius:0}}}));function Lt(e){var t=e.dispatch,n=e.roomId,a=e.loginFailed,i=Ut(),c=Object(r.useState)(""),s=Object(_e.a)(c,2),l=s[0],u=s[1],m=Object(r.useState)(!1),d=Object(_e.a)(m,2),p=d[0],f=d[1];a&&l&&!p&&(u(""),f(!0));var h=function(e){e.preventDefault(),f(!1),t(x(n,l))},b=a&&a.error?a.error.message:"Enter password to login";return o.a.createElement(We.a,{className:i.root,elevation:1},o.a.createElement(We.a,{elevation:2,style:{padding:"1em",width:"320px",margin:"auto"}},o.a.createElement("form",{style:{display:"flex",justifyContent:"center"},onSubmit:h},o.a.createElement(it.a,{label:"Password",type:"password",autoFocus:!0,helperText:b,error:!!a,value:l,onChange:function(e){u(e.target.value)}}),o.a.createElement(Le.a,{variant:"contained",style:{margin:"1em"},onClick:h},"Log in"))))}Lt.defaultProps={roomId:void 0,loginFailed:null};var Bt=Object(l.c)((function(e){return{roomId:e.room._id,loginFailed:e.socket.loginFailed}}))(Lt),Wt=function(e,t){return e+t},zt=function(e){return!e||e.penalties&&e.penalties.DNF?-1:e.time},Jt=function(e){return function(t){var n=t.slice(-e);if(!(n.length<e-1))return n.sort(),n[1]<0?-1:n[0]<0?(n.slice(1).reduce(Wt)-Math.max.apply(Math,Object(y.a)(n)))/(e-2):(n.reduce(Wt)-Math.min.apply(Math,Object(y.a)(n))-Math.max.apply(Math,Object(y.a)(n)))/(e-2)}},Ht=function(e){return(t=e.filter((function(e){return e>0}))).length?t.reduce(Wt)/t.length:void 0;var t},qt=function(e,t){var n=e.map((function(e){return e.results})),a={};return t.forEach((function(e){var t=n.map((function(t){return t[e.id]}));t&&0!==t.length&&(t=(t=t[t.length-1]?t:t.slice(0,-1)).map(zt),a[e.id]={mean:Ht(t),ao5:Jt(5)(t),ao12:Jt(12)(t)})})),a},Vt=n(291),Yt=n(292),Kt=n(293),Qt=n(295),Xt=n(294),$t=n(290),Zt=function(e){return(e<10?"0":"")+e},en=function(e,t){return Number(e).toFixed(void 0===t?2:t)},tn=function(e,t){var n=Object(j.a)({},t),a=n.inspection,r=n.AUF,o=n.DNF;if(void 0===e||null===e||e<0)return"DNF";var i=e/1e3;n.inspection&&(i+=2),n.auf&&(i+=2);var c=Math.floor(i/3600);i%=3600;var s=Math.floor(i/60),l=void 0!==n.milli?en(i%60,n.milli):en(i%60,i>600?0:2),u="".concat(c?"".concat(c,":"):"").concat(s?"".concat(c?Zt(s):s,":"):"").concat(s?Zt(l):l),m="".concat(a?"+":"").concat(u).concat(r?"+":"");return o?"DNF(".concat(m,")"):m},nn=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},an=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.clearTimeout,rn=function(e){var t={};return t.value=nn((function n(){e.call(),t.value=nn(n)})),t},on=function(e){e&&an(e.value)},cn=function(){return(window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now)()},sn=n(276),ln=Object(Se.a)((function(e){return{root:{display:"inline"},name:{padding:0},paper:{padding:e.spacing(1)},popover:{pointerEvents:"none"},p:{paddingBottom:".5em"}}}));var un=function(e){var t=e.user,n=ln(),a=o.a.useState(null),r=Object(_e.a)(a,2),i=r[0],c=r[1],s=function(){c(null)},l=Boolean(i);return o.a.createElement("div",{className:n.root},o.a.createElement(De.a,{className:n.name,"aria-haspopup":"true",onMouseEnter:function(e){c(e.currentTarget)},onMouseLeave:s,component:"span"},t.displayName),o.a.createElement(sn.a,{id:"".concat(t.displayName,"-info"),className:n.popover,classes:{paper:n.paper},open:l,anchorEl:i,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},disableRestoreFocus:!0},t.wcaId&&o.a.createElement(De.a,{className:n.p,variant:"body1"},"WCA ID: ".concat(t.wcaId)),t.name&&o.a.createElement(De.a,{className:n.p,variant:"body1"},"Name: ".concat(t.name)),t.username&&o.a.createElement(De.a,{className:n.p,variant:"body1"},"Username: ".concat(t.username))))},mn=Object(Se.a)((function(e){return{root:{flexGrow:1,display:"flex",overflowY:"auto"},table:{display:"flex",flexFlow:"column"},thead:{boxShadow:e.shadows[1]},tbody:{flexGrow:1,overflowY:"auto",height:"0px"},tr:{display:"table",tableLayout:"fixed",width:"100%"},tableHeaderTime:{paddingLeft:0},tableResultCell:{paddingLeft:"2em"},tableHeaderMean:{paddingLeft:16},disabled:{color:"#7f7f7f"}}}));function dn(e){var t=e.status,n=mn();return o.a.createElement($t.a,{className:n.tableResultCell,align:"left"},o.a.createElement("span",null,"RESTING"===t?"":t))}function pn(e){var t=e.attempt,n=t.time,a=t.penalties,r=e.highlight,i=mn(),c=tn(n,a);return o.a.createElement($t.a,{className:i.tableResultCell,align:"left"},o.a.createElement("span",{style:{color:r?"red":"black"}},null===n?"":c))}function fn(e){var t=e.room,n=t.users,a=t.statuses,i=t.attempts,c=t.competing,s=e.stats,l=mn(),u=Object(r.createRef)();u.current&&(u.current.scrollTop=0);var m=n.sort((function(e,t){return+c[t.id]-+c[e.id]}));return o.a.createElement(Vt.a,{className:l.root},o.a.createElement(Yt.a,{stickyHeader:!0,className:l.table,size:"small"},o.a.createElement(Kt.a,{className:l.thead},o.a.createElement(Xt.a,{className:l.tr},o.a.createElement($t.a,{align:"left",className:l.tableHeaderIndex},"#"),m.map((function(e){return o.a.createElement($t.a,{key:e.id,align:"left",className:Object(Rt.a)(l.tableHeaderTime,Object(N.a)({},l.disabled,!c[e.id]))},o.a.createElement(un,{user:e}),o.a.createElement("br",null))}))),o.a.createElement(Xt.a,{className:l.tr},o.a.createElement($t.a,{align:"left"},"mean"),m.map((function(e){return o.a.createElement($t.a,{key:e.id,align:"left",className:Object(Rt.a)(l.tableHeaderMean,Object(N.a)({},l.disabled,!c[e.id]))},o.a.createElement("span",null,s[e.id]?tn(s[e.id].mean).toString():""))})))),o.a.createElement(Qt.a,{className:l.tbody,ref:u},Object(y.a)(i).reverse().map((function(e,t){var r=n.map((function(t){return e.results[t.id]&&e.results[t.id].penalties&&!e.results[t.id].penalties.DNF?e.results[t.id].time:void 0})).filter((function(e){return!!e&&e>-1})),c=Math.min.apply(Math,Object(y.a)(r));return o.a.createElement(Xt.a,{className:l.tr,key:e.id},o.a.createElement($t.a,{align:"left"},i.length-t),m.map((function(n){return 0!==t||e.results[n.id]?o.a.createElement(pn,{key:n.id,attempt:e.results[n.id],highlight:e.results[n.id]&&e.results[n.id].time===c}):o.a.createElement(dn,{key:n.id,status:a[n.id]})})))})))))}dn.defaultProps={status:""},pn.defaultProps={attempt:{time:null,penalties:{}},highlight:!1},fn.defaultProps={room:{users:[],statuses:{},attempts:[],competing:{}},stats:{}};var hn=fn,bn=n(3),En=n(26),vn=n(306),gn=n(308),On=n(296),Nn=function(e){return{root:{display:"flex",width:"100%",height:"9em",flexGrow:0,textAlign:"center",flexDirection:"column",padding:"auto",justifyContent:"center"},disabled:{color:"#7f7f7f"},PRIMING:{color:"green"},INSPECTING_PRIMING:{color:"green"},INSPECTING:{color:"red"},fullscreen:{position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:e.zIndex.tooltip+1,backgroundColor:"white",transition:"background-color .2s ".concat(e.transitions.easing.easeInOut)}}},yn=Object(xt.a)(Nn),jn={RESTING:"RESTING",PRIMING:"PRIMING",INSPECTING:"INSPECTING",INSPECTING_PRIMING:"INSPECTING_PRIMING",TIMING:"TIMING",SUBMITTING_DOWN:"SUBMITTING_DOWN",SUBMITTING:"SUBMITTING"},In=[jn.RESTING,jn.INSPECTING,jn.TIMING,jn.SUBMITTING],wn=function(e){function t(e){var n;return Object(de.a)(this,t),(n=Object(St.a)(this,Object(_t.a)(t).call(this,e))).rootRef=o.a.createRef(),n.state={focused:!0,started:void 0,status:jn.RESTING,time:0,penalties:{}},n._keyDown=n.keyDown.bind(Object(En.a)(n)),n._keyUp=n.keyUp.bind(Object(En.a)(n)),n._touchStart=n.touchStart.bind(Object(En.a)(n)),n._touchEnd=n.touchEnd.bind(Object(En.a)(n)),n}return Object(kt.a)(t,e),Object(Tt.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this._keyDown,!1),window.addEventListener("keyup",this._keyUp,!1),this.rootRef.current&&(this.rootRef.current.addEventListener("touchstart",this._touchStart),this.rootRef.current.addEventListener("touchend",this._touchEnd))}},{key:"componentWillUnmount",value:function(){this.timerObj&&on(this.timerObj),window.removeEventListener("keydown",this._keyDown,!1),window.removeEventListener("keyup",this._keyUp,!1),this.rootRef.current&&(this.rootRef.current.removeEventListener("touchstart",this._touchStart,!1),this.rootRef.current.removeEventListener("touchend",this._touchEnd,!1))}},{key:"setStatus",value:function(e){var t=this.props.onStatusChange;switch(this.setState({status:e}),e){case jn.INSPECTING:case jn.TIMING:this.setState({started:cn(),time:0}),this.timerObj&&on(this.timerObj),this.timerObj=rn(this.tick.bind(this));break;case jn.SUBMITTING_DOWN:on(this.timerObj)}In.indexOf(e)>-1&&t(e)}},{key:"submitTime",value:function(){var e=this.props.onSubmitTime,t=this.state.penalties;e&&e({time:t.inspectionDNF?-1:this.finalTime(),penalties:{DNF:t.DNF||t.inspectionDNF,inspection:t.inspection,AUF:t.AUF}}),this.reset()}},{key:"reset",value:function(){this.setState({started:0,penalties:{}}),this.setStatus(jn.RESTING)}},{key:"keyDown",value:function(e){var t=this.props.disabled,n=this.state,a=n.focused,r=n.status;if(a&&!this.keyIsDown&&!t){if(192===e.keyCode&&r===jn.INSPECTING&&(on(this.timerObj),this.reset()),32===e.keyCode)switch(e.preventDefault(),r){case jn.RESTING:this.setStatus(jn.PRIMING);break;case jn.INSPECTING:this.setStatus(jn.INSPECTING_PRIMING)}r===jn.TIMING&&this.setStatus(jn.SUBMITTING_DOWN),this.keyIsDown=!0}}},{key:"keyUp",value:function(e){var t=this.props.useInspection,n=this.state,a=n.focused,r=n.status;if(this.keyIsDown=!1,a){if(13===e.keyCode&&r===jn.SUBMITTING&&(e.preventDefault(),this.submitTime()),32===e.keyCode)switch(e.preventDefault(),r){case jn.PRIMING:this.setStatus(t?jn.INSPECTING:jn.TIMING);break;case jn.INSPECTING_PRIMING:this.setStatus(jn.TIMING)}r===jn.SUBMITTING_DOWN&&this.setStatus(jn.SUBMITTING)}}},{key:"touchStart",value:function(e){var t=this.props,n=t.focused,a=t.disabled,r=this.state.status;if(n&&!this.keyIsDown&&!a){switch(r){case jn.TIMING:this.setStatus(jn.SUBMITTING_DOWN);break;case jn.RESTING:e.preventDefault(),this.setStatus(jn.PRIMING);break;case jn.INSPECTING:this.setStatus(jn.INSPECTING_PRIMING)}this.keyIsDown=!0}}},{key:"touchEnd",value:function(e){var t=this.props.useInspection,n=this.state.status;switch(this.keyIsDown=!1,n===jn.SUBMITTING_DOWN&&e.preventDefault(),n){case jn.SUBMITTING_DOWN:this.setStatus(jn.SUBMITTING);break;case jn.PRIMING:this.setStatus(t?jn.INSPECTING:jn.TIMING);break;case jn.INSPECTING_PRIMING:this.setStatus(jn.TIMING)}}},{key:"inspecting",value:function(){return this.state.status.split("_")[0]===jn.INSPECTING}},{key:"tick",value:function(){var e=this,t=this.state,n=t.status,a=t.time,r=t.started,o=t.penalties;this.inspecting()?(a<-2e3?(o.inspectionDNF=!0,setTimeout((function(){on(e.timerObj)}),1),this.setStatus(jn.SUBMITTING)):a<0&&(o.inspection=!0),this.setState({time:15e3-(cn()-r)})):n===jn.TIMING&&this.setState({time:cn()-r})}},{key:"timerText",value:function(){var e=this.props.hideTime,t=this.state,n=t.time,a=t.status;return e&&a===jn.TIMING?"Solving...":n<0&&this.inspecting()?"+2":tn(n,{milli:this.inspecting()?0:2})}},{key:"statusText",value:function(){var e=this.props.disabled,t=this.state.status;return e?"disabled":"SUBMITTING"===t?"Press Enter to Submit":t}},{key:"flipPenality",value:function(e){var t=this.state.penalties;this.setState({penalties:Object(j.a)({},t,Object(N.a)({},e,!t[e]))})}},{key:"finalTime",value:function(){var e=this.state,t=e.time,n=e.penalties,a=t;return n.inspection&&(a+=2e3),n.AUF&&(a+=2e3),a}},{key:"renderSubmitting",value:function(){var e=this,t=this.state.penalties,n=t.inspection,a=t.inspectionDNF,r=t.AUF,i=t.DNF||a,c="".concat(n?"2 +":"").concat(this.timerText()).concat(r?" + 2":""," = "),s=(r||n||i?c:"")+tn(this.finalTime(),t);return o.a.createElement("div",null,o.a.createElement(De.a,{variant:"h4"},a?"DNF":s),o.a.createElement(On.a,{row:!0,style:{justifyContent:"center"}},o.a.createElement(st.a,{control:o.a.createElement(gn.a,{size:"medium",variant:"outlined"},"AUF"),label:"AUF",value:r,onChange:function(){return e.flipPenality("AUF")}}),o.a.createElement(st.a,{control:o.a.createElement(gn.a,{size:"medium",variant:"outlined"},"DNF"),label:"DNF",value:i,onChange:function(){return e.flipPenality("DNF")}}),o.a.createElement(Le.a,{variant:"outlined",onClick:function(){return e.submitTime()}},"SUBMIT"),o.a.createElement(Le.a,{variant:"outlined",onClick:function(){return e.reset()}},"REDO")),o.a.createElement(De.a,{variant:"subtitle1"},"Or press Enter to submit time"))}},{key:"renderTiming",value:function(){var e=this.props,t=e.classes,n=e.disabled,a=this.state,r=a.focused,i=a.status;return o.a.createElement(o.a.Fragment,null,o.a.createElement(De.a,{variant:"h1",className:Object(Rt.a)(Object(N.a)({},t.disabled,n||!r),t[i])},this.timerText()),"","")}},{key:"render",value:function(){var e=this.props.classes,t=this.state.status;return o.a.createElement(vn.a,{className:Object(Rt.a)(e.root,Object(N.a)({},e.fullscreen,t!==jn.RESTING)),ref:this.rootRef},t===jn.SUBMITTING?this.renderSubmitting():this.renderTiming())}}]),t}(o.a.Component);wn.defaultProps={disabled:!1,focused:!0,hideTime:!1,onStatusChange:function(){}};var Cn=yn(wn),Tn=n(225),Sn=Object(Se.a)((function(e){return{root:Object(j.a)({},Nn(e).root,{flexDirection:"column",alignItems:"center"}),input:{maxWidth:"300px",margin:"auto",fontSize:"3em",backgroundColor:e.palette.grey[300]},inputProps:{textAlign:"center","&:focus":{backgroundColor:e.palette.grey[400],border:"1px solid ".concat(e.palette.divider),borderRadius:e.borderRadius}},penaltyBox:{display:"flex",flexDirection:"row",alignItems:"center"}}}));function _n(e){var t=e.match(/^(?:(\d*):)??(?:(\d*):)?(\d+)?(?:[.,](\d*))?$/),n=parseInt(t[1]||"0",10),a=parseInt(t[2]||"0",10),r=parseInt(t[3]||"0",10),o=t[4]||"",i=parseInt(o||"0",10),c=Math.pow(10,o.length-2),s=i?Math.round(i/c):0;return n||a||s?10*(100*(60*n+60*a+r)+s):function(e){var t=e%1e4;return 10*(t+6e3*((e-t)/1e4%100)+36e4*Math.floor((e-t)/1e4/100))}(parseInt(t[3]||"0",10))}var kn={spacebar:Cn,manual:function(e){var t=e.disabled,n=e.onSubmitTime,a=Sn(),r=o.a.useState(""),i=Object(_e.a)(r,2),c=i[0],s=i[1],l=o.a.useState(!1),u=Object(_e.a)(l,2),m=u[0],d=u[1],p=o.a.useState(!1),f=Object(_e.a)(p,2),h=f[0],b=f[1],E=function(e){e.preventDefault();var t=_n(c);t&&(n({time:t,penalties:{DNF:m,AUF:h}}),b(!1),d(!1),s(""))};return o.a.createElement(vn.a,{className:a.root},o.a.createElement("form",{onSubmit:E},o.a.createElement(Tn.a,{className:a.input,component:"textarea",inputProps:{className:a.inputProps},disabled:t,value:c,onChange:function(e){return s(e.target.value)},disableUnderline:!0,fullWidth:!0})),o.a.createElement("div",{className:a.penaltyBox},o.a.createElement(st.a,{control:o.a.createElement(gn.a,{size:"medium",variant:"outlined",checked:h,onChange:function(){return b(!h)}}),label:"AUF"}),o.a.createElement(st.a,{control:o.a.createElement(gn.a,{size:"medium",variant:"outlined",checked:m,onChange:function(){return d(!m)}}),label:"DNF"}),o.a.createElement(Le.a,{variant:"outlined",onClick:E},"SUBMIT")))}};function Rn(e){var t=e.type,n=e.disabled,a=e.focused,r=e.onSubmitTime,i=Object(bn.a)(e,["type","disabled","focused","onSubmitTime"]),c=kn[t];return o.a.createElement(c,Object.assign({disabled:n,focused:a,onSubmitTime:r},i))}Rn.defaultProps={type:"spacebar",disabled:!1,focused:!0,onStatusChange:function(){}};var xn=Rn,Dn=Object(Se.a)((function(){return{root:{margin:".5em",textAlign:"center","-webkit-user-select":"text","-webkit-touch-callout":"text","-moz-user-select":"text","-ms-user-select":"text","user-select":"text"},scramble:{fontFamily:"Roboto Mono, monospace",fontSize:"1.25em"},disabled:{color:"#7f7f7f"},minx:{lineHeight:"1.25em",fontSize:"1.25em"},line:{display:"block"}}}));function Mn(e){var t=e.scramble,n=Dn();return t.split("\n").map((function(e,t){return o.a.createElement("span",{key:t.toString(),className:n.line},e,41===e.length?o.a.createElement(o.a.Fragment,null,"\xa0"):"")}))}function Gn(e){var t=e.event,n=e.scrambles,a=e.disabled,r=Dn();return o.a.createElement("div",{className:Object(Rt.a)(r.root,Object(N.a)({},r.disabled,a))},o.a.createElement(De.a,{variant:"subtitle2",className:Object(Rt.a)(Object(N.a)({},r[t],!0),r.scramble)},n.length?n.map((function(e){return"minx"===t?o.a.createElement(Mn,{scramble:e}):e})):"No Scrambles"))}Gn.defaultProps={event:"333",scrambles:[],disabled:!1};var Pn=Gn,Fn=Object(Se.a)((function(){return{root:{padding:0,marging:0}}}));function An(e){var t=e.stats,n=Fn(),a=Object.keys(t).filter((function(e){return!!t[e]}));return a&&0!==a.length?o.a.createElement(We.a,{className:n.root,square:!0,elevation:4},o.a.createElement(Yt.a,{size:"small"},o.a.createElement(Kt.a,null,o.a.createElement(Xt.a,null,a.map((function(e){return o.a.createElement($t.a,{key:e},e)})))),o.a.createElement(Qt.a,null,o.a.createElement(Xt.a,null,a.map((function(e){return o.a.createElement($t.a,{key:e},tn(t[e]))})))))):""}An.defaultProps={stats:{}};var Un=An,Ln=Object(Se.a)((function(e){return{root:{display:"flex",flexGrow:1,flexDirection:"column",padding:e.spacing(0),borderRadius:0,height:"100%"},waitingForBox:{padding:".5em"}}}));function Bn(e){var t=e.dispatch,n=e.room,a=e.user,r=e.timerFocused,i=Ln(),c=o.a.useState("spacebar"),s=Object(_e.a)(c,2),l=s[0],u=s[1],m=n.users,d=n.attempts,p=n.waitingFor,f=d&&d.length?d[d.length-1]:{},h=!r||!n.competing[a.id]||-1===n.waitingFor.indexOf(a.id),b=qt(d,m);return o.a.createElement(We.a,{className:i.root,variant:"outlined",square:!0},o.a.createElement(Pn,{event:n.event,disabled:h,scrambles:f.scrambles}),o.a.createElement(et.a,null),o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement(Le.a,{style:{fontSize:".75em",padding:0},onClick:function(){u("spacebar"===l?"manual":"spacebar")}},"Switch to"," ","spacebar"===l?"manual":"spacebar"),o.a.createElement(xn,{disabled:h,onSubmitTime:function(e){return function(e){if(n.attempts.length&&a.id){var r=n.attempts?n.attempts[n.attempts.length-1]:{};t(D({id:r.id,result:{time:e.time,penalties:e.penalties}}))}}(e)},onStatusChange:function(e){t(M(e))},useInspection:a.useInspection,type:l})),o.a.createElement(et.a,null),o.a.createElement(hn,{room:n,stats:b}),o.a.createElement(Un,{stats:b[a.id]}),o.a.createElement(We.a,{className:i.waitingForBox,square:!0},o.a.createElement(De.a,{variant:"body2"},"Waiting For:"," ",p.map((function(e){return m.find((function(t){return t.id===e}))})).filter((function(e){return!!e})).map((function(e){return e.displayName})).join(", "))))}Bn.defaultProps={room:{_id:void 0,private:!1,accessCode:void 0,event:"333",users:[],competing:{},waitingFor:[],statues:{},attempts:[],admin:{id:void 0}},user:{id:void 0,useInspection:!1},timerFocused:!0};var Wn=Object(l.c)((function(e){return{room:e.room,user:e.user}}))(Bn),zn=n(227),Jn=n(299),Hn=n(298),qn=n(297),Vn=n(140),Yn=n.n(Vn),Kn=n(139),Qn=n.n(Kn),Xn={USER:o.a.createElement(Qn.a,null),ADMIN:o.a.createElement(Yn.a,null),SCRAMBLE:function(e){return o.a.createElement(qn.a,{className:"cubing-icon event-".concat(e)})}},$n=Object(Se.a)((function(){return{root:{display:"flex",flexGrow:1,flexDirection:"column",height:"100%"},messages:{display:"flex",flexGrow:1,flexDirection:"column",overflowY:"auto",height:0,padding:0},paper:{display:"flex",flexGrow:0,width:"100%",padding:"1em",backgroundColor:"#fefefe",borderRadius:0},message:{paddingTop:0,paddingBottom:0,margin:0},systemMessage:{marginTop:0,marginBottom:0},lastMessageForUser:{marginBottom:".5em"},selectable:{"-webkit-user-select":"text","-webkit-touch-callout":"text","-moz-user-select":"text","-ms-user-select":"text","user-select":"text"}}}));function Zn(e){var t=e.dispatch,n=e.messages,a=e.users,i=e.onFocus,c=e.onDefocus,s=$n(),l=Object(r.useState)(""),u=Object(_e.a)(l,2),m=u[0],d=u[1],p=Object(r.useRef)();return Object(r.useEffect)((function(){p.current.scrollTop=p.current.scrollHeight}),[n]),o.a.createElement(Hn.a,{onClickAway:c},o.a.createElement(We.a,{className:s.root,variant:"outlined",square:!0,onClick:i},o.a.createElement(tt.a,{className:s.messages,ref:p},n.map((function(e,t){var r=e.id,i=e.userId,c=e.text,l=e.secondary,u=e.icon,m=e.event;if(-1===i)return o.a.createElement(Fe.a,{dense:!0,key:r,className:s.systemMessage},o.a.createElement(nt.a,{style:{display:"block"}},"SCRAMBLE"===u?Xn[u](m):Xn[u]),o.a.createElement(Ae.a,{className:s.selectable,primary:o.a.createElement(De.a,{variant:"body1"},c),secondary:o.a.createElement(De.a,{variant:"body2"},l)}));var d=function(e){return a.find((function(t){return t.id===e}))}(i),p=!(d&&d.avatar.url)||0===t||n[t-1].userId!==d.id,f=n[t+1]&&n[t+1].userId===d.id;return o.a.createElement(Fe.a,{key:r,alignItems:"flex-start",className:Object(Rt.a)(s.message,Object(N.a)({},s.lastMessageForUser,!f))},o.a.createElement(Jn.a,null,p&&o.a.createElement(Pe.a,{src:d.avatar.url})),o.a.createElement(Ae.a,{className:s.selectable,primary:p?d.displayName:"",secondary:o.a.createElement(De.a,{variant:"body2"},c)}))}))),o.a.createElement(We.a,{component:"form",onSubmit:function(e){e.preventDefault(),t(re({text:m})),d("")},className:s.paper,elevation:8},o.a.createElement(zn.a,{fullWidth:!0},o.a.createElement(Tn.a,{className:s.input,fullWidth:!0,placeholder:"Send message",value:m,onChange:function(e){return d(e.target.value)}})))))}Zn.defaultProps={messages:[],users:[],onFocus:function(){},onDefocus:function(){}};var ea=Object(l.c)((function(e){return{messages:e.chat.messages,users:e.chat.users}}))(Zn),ta=n(230),na=n(141),aa=n.n(na),ra=Object(Se.a)((function(){return{adminToolbar:{flexDirection:"row-reverse",alignItems:"stretch",minHeight:"5em",padding:0,flexGrow:1},changeEventSelect:{paddingLeft:".5em",paddingRight:".5em"}}}));function oa(e){var t=e.dispatch,n=e.room,a=ra(),r=o.a.useState(null),i=Object(_e.a)(r,2),c=i[0],s=i[1],l=Boolean(c);return o.a.createElement(Me.a,{className:a.adminToolbar},o.a.createElement(On.a,{row:!0,variant:"text"},o.a.createElement(Le.a,{disabled:!(n&&n.attempts.length&&Object.keys(n.attempts[n.attempts.length-1].results).length),onClick:function(){t(G())}},"New Scramble"),o.a.createElement(ta.a,{id:"change-event-select",className:a.changeEventSelect,value:n.event,onChange:function(e){t(P(e.target.value))},variant:"standard"},Ye.map((function(e){return o.a.createElement(Be.a,{key:e.id,dense:!0,value:e.id},e.name)}))),o.a.createElement(Le.a,{color:"inherit",onClick:function(e){s(e.currentTarget)},style:{paddingLeft:"1em"}},o.a.createElement(aa.a,null))),o.a.createElement(Ue.a,{id:"admin-menu",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:function(){s(null)}},o.a.createElement(Be.a,{onClick:function(){t(R(n._id))}},"Delete Room")))}oa.defaultProps={room:{_id:void 0,attempts:[],event:void 0}};var ia=Object(l.c)((function(e){return{room:e.room}}))(oa),ca=Object(Se.a)((function(){return{root:{alignItems:"stretch",minHeight:"5em",padding:0,flexGrow:1}}}));function sa(e){var t=e.dispatch,n=e.room,a=e.user,r=ca(),i=n.competing[a.id];return o.a.createElement(Me.a,{className:r.root},o.a.createElement(On.a,{row:!0,variant:"text"},o.a.createElement(Le.a,{onClick:function(){t(F(!i))}},i?"Start Skipping":"Start Competing")))}sa.defaultProps={room:{competing:{}},user:{id:void 0}};var la=Object(l.c)((function(e){return{room:e.room,user:e.user}}))(sa),ua=[{name:"Timer",icon:o.a.createElement(At.a,null)},{name:"Chat",icon:o.a.createElement(Pt.a,null)}],ma=Object(xt.a)((function(e){return{root:Object(N.a)({display:"flex",flexGrow:1,flexDirection:"column",margin:"auto",width:"100%"},e.breakpoints.up("lg"),{width:"83.333333%"}),bottomNav:Object(N.a)({width:"100%",height:"4em",flexGrow:0,backgroundColor:"#e6e6e6"},e.breakpoints.up("md"),{display:"none"}),bottomNavItem:{display:"flex",flexGrow:1,maxWidth:"100%"},hiddenOnMobile:Object(N.a)({},e.breakpoints.down("sm"),{display:"none"}),container:{flexGrow:1},panel:{flexGrow:1,transition:"display 5s ".concat(e.transitions.easing.easeInOut)},backdrop:{zIndex:e.zIndex.drawer+1},toolbarContainer:{display:"flex",flexDirection:"row"}}})),da=function(e){function t(e){var n;Object(de.a)(this,t);var a=(n=Object(St.a)(this,Object(_t.a)(t).call(this,e))).props,r=a.dispatch,i=a.match,c=a.room,s=a.inRoom;return n.state={timerFocused:!0,currentPanel:0},n.tableBodyRef=o.a.createRef(),c._id||r(k(i.params.roomId)),!s&&c.accessCode&&r(x(c._id)),n}return Object(kt.a)(t,e),Object(Tt.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.dispatch,n=e.room;!e.inRoom&&n.accessCode&&t(x(n._id))}},{key:"onFocus",value:function(){this.setState({timerFocused:!1})}},{key:"onDefocus",value:function(){this.setState({timerFocused:!0})}},{key:"isAdmin",value:function(){var e=this.props,t=e.room,n=e.user;return t.admin&&t.admin.id===n.id}},{key:"handleChangePanel",value:function(e,t){this.setState({currentPanel:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.fetching,r=t.inRoom,i=t.room,c=this.state,s=c.currentPanel,l=c.timerFocused,u=!i.private||r;return a?o.a.createElement(Ie.a,{open:!0},o.a.createElement(we.a,{color:"inherit"})):o.a.createElement(We.a,{className:n.root},o.a.createElement(We.a,{className:n.toolbarContainer,square:!0},o.a.createElement(la,null),this.isAdmin()&&o.a.createElement(ia,null)),o.a.createElement(et.a,null),o.a.createElement(Re.a,{container:!0,direction:"row",className:n.container},u?o.a.createElement(o.a.Fragment,null,o.a.createElement(Re.a,{item:!0,className:Object(Rt.a)(n.panel,Object(N.a)({},n.hiddenOnMobile,0!==s)),md:8},o.a.createElement(Wn,{timerFocused:l})),o.a.createElement(Re.a,{item:!0,className:Object(Rt.a)(n.panel,Object(N.a)({},n.hiddenOnMobile,1!==s)),md:4},o.a.createElement(ea,{onFocus:function(){return e.onFocus()},onDefocus:function(){return e.onDefocus()}}))):o.a.createElement(Bt,null)),o.a.createElement(Dt.a,{value:s,showLabels:!0,onChange:function(t,n){return e.handleChangePanel(t,n)},className:n.bottomNav},ua.map((function(e,t){return o.a.createElement(Mt.a,{key:e.name,className:n.bottomNavItem,label:e.name,value:t,icon:e.icon})}))))}}]),t}(o.a.Component);da.defaultProps={fetching:!0,room:{_id:void 0,private:!1,accessCode:void 0},user:{id:void 0},inRoom:!1};var pa=Object(l.c)((function(e){return{fetching:e.room.fetching,room:e.room,inRoom:!!e.socket.room,user:e.user}}))(ma(da)),fa=n(231),ha=n(303),ba=n(228),Ea=Object(Se.a)((function(e){return{root:{display:"flex",width:"100%",border:"1px solid ".concat(e.palette.divider),transition:"2s",padding:"1em",justifyContent:"space-between",borderRadius:e.borderRadius,marginBottom:"1em"},divider:{height:28,margin:4}}}));function va(e){var t=e.label,n=e.value,a=e.onChange,i=e.validate,c=Ea(),s=Object(r.useState)(!1),l=Object(_e.a)(s,2),u=l[0],m=l[1],d=Object(r.useState)(n),p=Object(_e.a)(d,2),f=p[0],h=p[1],b=Object(r.useState)(),E=Object(_e.a)(b,2),v=E[0],g=E[1],O=function(){m(!0),h(n),g(!1)},N=function(){m(!1),h(n)},y=function(e){e.preventDefault(),f===n||i(f)||a(f,(function(e){e&&g(e)})),N()};return o.a.createElement(Hn.a,{onClickAway:N},o.a.createElement(We.a,{component:"form",className:c.root,onSubmit:y},o.a.createElement(zn.a,{fullWidth:!0,disabled:!u,error:!!v,onClick:O},o.a.createElement(fa.a,{style:{width:"10em"}},t),o.a.createElement(Tn.a,{value:u?f:n,onChange:function(e){h(e.target.value),g(i(e.target.value))},inputRef:function(e){e&&e.focus()},margin:"dense"}),o.a.createElement(ba.a,null,v)),u?o.a.createElement(ha.a,null,o.a.createElement(Le.a,{variant:"text",onClick:y,color:"primary",disabled:n===f},"Change"),o.a.createElement(Le.a,{variant:"text",onClick:N},"Cancel")):o.a.createElement(Le.a,{variant:"text",onClick:O,color:"primary",style:{marginLeft:"auto",marginRight:0,order:2}},"Change")))}va.defaultProps={value:void 0};var ga=va,Oa=function(e){return e?e.indexOf(" ")>-1?"Username cannot contains spaces":e.length>=16?"Username cannot be longer than 16 characters":"":""},Na=Object(Se.a)((function(e){return{root:{flexGrow:1,padding:"1em"},avatar:{width:"10em",height:"10em",boxShadow:e.shadows[1]},avatarContainer:{display:"flex",flexGrow:1,flexDirection:"row-reverse"},preferences:{padding:"1em"},input:{display:"flex",flexDirection:"column",width:"100%",border:"1px solid ".concat(e.palette.divider),transition:"2s",padding:"1em",borderRadius:e.borderRadius,marginBottom:"1em"},separate:{marginTop:".5em",marginBottom:".5em"},indent:{marginLeft:"1em"}}}));function ya(e){var t=e.user,n=e.dispatch,a=Na(),r=function(e){var t=e.target,a=t.name,r=t.checked;fetch("/api/updatePreference",{headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify(Object(N.a)({},a,r))}).then((function(e){return e.json()})).then((function(e){var t;n(V((t={},Object(N.a)(t,a,e[a]),Object(N.a)(t,"displayName",e.displayName),Object(N.a)(t,"canJoinRoom",e.canJoinRoom),t)))}))};return t.id?o.a.createElement(Re.a,{container:!0,justify:"center",className:a.root},o.a.createElement(Re.a,{item:!0,xs:12,md:8},!t.canJoinRoom&&o.a.createElement(Te.a,{severity:"error",style:{fontSize:"1.25em"}},"Must set a username or check `Prefer Real Name` before joining a room."),o.a.createElement(We.a,null,o.a.createElement(Re.a,{container:!0,style:{padding:"2em",justifyContent:"space-between"}},o.a.createElement(Re.a,{item:!0,xs:4},o.a.createElement("div",null,o.a.createElement(De.a,{component:"span",variant:"body1"},"Displaying as:"),t.displayName?o.a.createElement(De.a,{component:"span",variant:"subtitle2",className:a.indent},t.displayName):o.a.createElement(De.a,{component:"span",variant:"subtitle2",className:a.indent},"NO NAME SET")),o.a.createElement(et.a,{className:a.separate}),o.a.createElement("div",{className:a.separate},o.a.createElement(De.a,{component:"span",variant:"body1"},"Real name (",t.showWCAID?"Visible":"Hidden","):"),o.a.createElement(De.a,{component:"span",variant:"subtitle2",className:a.indent},t.name)),o.a.createElement("div",{className:a.separate},o.a.createElement(De.a,{component:"span",variant:"body1"},"WCA ID (",t.showWCAID?"Visible":"Hidden","):"),o.a.createElement(De.a,{component:"span",variant:"subtitle2",className:a.indent},t.wcaId))),o.a.createElement(Re.a,{item:!0,lg:2,className:a.avatarContainer},o.a.createElement(Pe.a,{variant:"square",className:a.avatar,src:t.avatar.url}))),o.a.createElement(Re.a,{container:!0,className:a.preferences},o.a.createElement(ga,{label:"Username",value:t.username,onChange:function(e,t){fetch("/api/updateUsername",{headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify({username:e})}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){n(V({username:e.username,displayName:e.displayName,canJoinRoom:e.canJoinRoom})),t()})).catch((function(e){e.json().then((function(e){t(e.message)}))}))},validate:Oa}),o.a.createElement(We.a,{className:a.input},o.a.createElement(st.a,{control:o.a.createElement(gn.a,{checked:t.preferRealName,onChange:r,name:"preferRealName"}),label:"Prefer Real Name"}),o.a.createElement(st.a,{control:o.a.createElement(gn.a,{checked:t.showWCAID,onChange:r,name:"showWCAID"}),label:"Show WCA Identity"}),o.a.createElement(st.a,{control:o.a.createElement(gn.a,{checked:t.useInspection,onChange:r,name:"useInspection"}),label:"Use inspection"}),o.a.createElement("p",null,"All preferences get saved automatically.")))))):o.a.createElement("div",null)}ya.defaultProps={user:{id:void 0,displayName:void 0,name:"",username:"",preferRealName:!1,showWCAID:!1,canJoinRoom:!1,wcaId:"",useInspection:!1,avatar:{url:void 0}}};var ja=Object(l.c)((function(e){return{user:e.user}}))(ya),Ia=Object(Se.a)((function(e){return{root:{display:"flex",height:"100vh",flexDirection:"column","-webkit-user-select":"none","-webkit-touch-callout":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},backdrop:{zIndex:e.zIndex.drawer+1},backdropContainer:{textAlign:"center",verticalAlign:"middle"},drawerHeader:Object(j.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"flex-end"})}}));function wa(e){var t=e.dispatch,n=e.connected,a=e.user,r=e.room,i=e.messages,c=Ia(),s=function(e,n,a){"clickaway"!==a&&t(Z(e))};return o.a.createElement("div",{className:c.root},o.a.createElement(Ie.a,{className:c.backdrop,open:!n},o.a.createElement(we.a,{color:"inherit"}),o.a.createElement(Ce.a,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"}},o.a.createElement(Te.a,{severity:"error"},"Disconnected from server."))),o.a.createElement($e,{user:a,room:r},o.a.createElement(je.d,null,o.a.createElement(je.b,{exact:!0,path:"/",component:Ct}),(!a.id||a.canJoinRoom)&&o.a.createElement(je.b,{path:"/rooms/:roomId",component:pa}),(a.id||a.fetching)&&o.a.createElement(je.b,{exact:!0,path:"/profile",component:ja,user:a}),o.a.createElement(je.a,{to:"/"}))),i[0]?o.a.createElement(Ce.a,{open:!!i[0],autoHideDuration:6e3,onClose:function(e,t){return s(0,0,t)},anchorOrigin:{vertical:"bottom",horizontal:"left"}},o.a.createElement(Te.a,{onClose:function(e,t){return s(0,0,t)},severity:i[0].severity},i[0].text)):"")}wa.defaultProps={connected:!1,messages:[]};var Ca=Object(l.c)((function(e){return{connected:e.socket.connected,room:e.room,user:e.user}}))(wa);var Ta=function(){return o.a.createElement(s.AppContainer,null,o.a.createElement(l.a,{store:ye},o.a.createElement(u.a,{history:ve,noInitialPop:!0},o.a.createElement(m.a,{theme:h},o.a.createElement(d.a,null),o.a.createElement(Ca,null)))))},Sa=n(145),_a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ka(e,t){new Sa.a("/custom-service-worker.js").register()}ye.dispatch({type:"socket/connect"}),ye.dispatch((function(e){return e({type:"user/fetching",fetching:!0}),fetch("/api/me").then((function(e){if(!e.ok)throw new Error(e.statusCode);return e.json()})).then((function(t){return e(q(t))})).catch((function(){e(q())}))}));c.a.render(o.a.createElement(Ta,null),document.querySelector("#root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/custom-service-worker.js");_a?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ka(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ka(t,e)}))}}()},9:function(e,t){e.exports={MESSAGE:"message",CONNECT:"connect",DISCONNECT:"disconnect",CONNECT_ERR:"connect_error",RECONNECT_ERR:"reconnect_error",RECONNECT:"reconnect",ERROR:"errorrr",UPDATE_ROOMS:"update_rooms",UPDATE_ROOM:"update_room",GLOBAL_ROOM_UPDATED:"global_room_updated",CREATE_ROOM:"create_room",DELETE_ROOM:"delete_room",ROOM_CREATED:"room_created",ROOM_DELETED:"room_deleted",UPDATE_ADMIN:"update_admin",FORCE_JOIN:"force_join",FETCH_ROOM:"fetch_room",JOIN_ROOM:"join_room",LEAVE_ROOM:"leave_room",JOIN:"join",USER_JOIN:"user_join",USER_LEFT:"user_left",SUBMIT_RESULT:"submit_result",NEW_RESULT:"new_result",NEW_ATTEMPT:"new_attempt",REQUEST_SCRAMBLE:"request_scramble",CHANGE_EVENT:"change_event",UPDATE_PREFERENCES:"update_preferences",UPDATE_STATUS:"update_status",UPDATE_COMPETING:"update_competing"}}},[[175,1,2]]]);
//# sourceMappingURL=main.9a5912f4.chunk.js.map